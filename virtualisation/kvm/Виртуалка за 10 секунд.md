Быстрый способ плодить виртуалки пачками
----------------------------------------

1. Создаём пустую виртуалку традиционным методом из iso-шника.
2. Накатываем все апдейты, устаналиваем необходимые утилиты, отключаем ненужные службы, включаем нужные, например последовательную консоль, чтобы иметь потом доступ из virsh.

   Назовём её 'first'
3. Из эталонной виртуалки клонируем новую, которая будет мастер-образом для всех последующих клонов:
   Назовём её 'master'
```
virt-clone -o first -n master -f /<путь до пула с образами дисков>/master.qcow2 --connect=qemu:///system
```
4. Удалим из мастер-образа всякие идентификаторы, обезличим её, но для удобства добавим ssh-ключ
```
virt-sysprep -d master --ssh-inject root:file:/<путь до файла>/id_rsa.pub
```
Подробнее об этом можно почитать здесь

http://libguestfs.org/virt-sysprep.1.html

или здесь

https://www.cyberciti.biz/faq/reset-a-kvm-clone-virtual-machines-with-virt-sysprep-on-linux/

5. Теперь можно ставить клонирование на поток
```
virt-clone -o master -n vm1 -f /<путь до пула с образами дисков>/vm1.qcow2 --connect=qemu:///system
```
6. Запускаем
```
virsh start vm1
```
Каждая вновь созданная виртуалка получит свой MAC-адрес и прочие уникальные атрибуты.
Время, потраченное на создание каждой новой виртуалки измеряется секундами.
